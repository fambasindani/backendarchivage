utilisateurs
 id
 nom
 prenom
 email
 password
 role
 statut|active|inactive|bloqué
 datecreation
 dernierconnection


 roles
 id
 nom
 description



 permissions
 id
 code
 description




 utilisateur_roles
 id
 id_utilisateur
 id_role


 roles_permissions
 id_role
 id_permission















 -- Table: utilisateurs
CREATE TABLE utilisateurs (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nom VARCHAR(100) NOT NULL,
    prenom VARCHAR(100) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    role VARCHAR(50) DEFAULT 'utilisateur',
    statut ENUM('active', 'inactive', 'bloqué') DEFAULT 'active',
    datecreation TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    dernierconnection TIMESTAMP NULL
);

-- Table: roles
CREATE TABLE roles (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nom VARCHAR(100) UNIQUE NOT NULL,
    description TEXT
);

-- Table: permissions
CREATE TABLE permissions (
    id INT PRIMARY KEY AUTO_INCREMENT,
    code VARCHAR(100) UNIQUE NOT NULL,
    description TEXT
);

-- Table: utilisateur_roles
CREATE TABLE utilisateur_roles (
    id INT PRIMARY KEY AUTO_INCREMENT,
    id_utilisateur INT,
    id_role INT,
    FOREIGN KEY (id_utilisateur) REFERENCES utilisateurs(id) ON DELETE CASCADE,
    FOREIGN KEY (id_role) REFERENCES roles(id) ON DELETE CASCADE,
    UNIQUE KEY unique_user_role (id_utilisateur, id_role)
);

-- Table: roles_permissions
CREATE TABLE roles_permissions (
    id_role INT,
    id_permission INT,
    FOREIGN KEY (id_role) REFERENCES roles(id) ON DELETE CASCADE,
    FOREIGN KEY (id_permission) REFERENCES permissions(id) ON DELETE CASCADE,
    PRIMARY KEY (id_role, id_permission)
);

-- Insertion de données initiales
INSERT INTO roles (nom, description) VALUES 
('admin', 'Administrateur système avec tous les droits'),
('moderateur', 'Modérateur avec des droits limités'),
('utilisateur', 'Utilisateur standard');

INSERT INTO permissions (code, description) VALUES 
('user_create', 'Créer des utilisateurs'),
('user_read', 'Voir les utilisateurs'),
('user_update', 'Modifier les utilisateurs'),
('user_delete', 'Supprimer des utilisateurs'),
('content_create', 'Créer du contenu'),
('content_read', 'Voir le contenu'),
('content_update', 'Modifier le contenu'),
('content_delete', 'Supprimer du contenu');

-- Attribution des permissions aux rôles
INSERT INTO roles_permissions (id_role, id_permission) VALUES 
(1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8),
(2, 2), (2, 5), (2, 6), (2, 7),
(3, 6);


 